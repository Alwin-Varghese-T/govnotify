<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<style>
  .error {
  border-color: red;
}
</style>
<script>
$(document).ready(function() {
  // Hide all form blocks except the first one
  $('.form-block:not(:first)').hide();
  $('#hide_otp').hide();
  // Function to send otp
  $('#send-otp').click(function(){
    var currentBlock = $(this).closest('.form-block');
    var requiredField_email = currentBlock.find(':input[data-name="email"][required]');
  
    if(requiredField_email=='')
    {
      
    }
    else
    {
        $.ajax({
            url: '/send_otp',
            type: 'POST',
            data: $('#register-form').serialize(),
            success: function(response){
                if(response.status === 'success'){
                    $('#hide_otp').show();
                    $('#message').html(response.message);
                } else {
                    alert(response.message);
                }
            }
          });
      }
  });
  //funtion to verify otp
  $('#verify-otp').click(function(){
    
    $.ajax({
      url: '/verify',
      type: 'POST',
      data: $('#register-form').serialize(),
      success: function(response){
        if(response.status === 'success'){
          $('#hide_otp').hide();
          $('#message').html(response.message);
        } else {
          alert(response.message);
        }
      }
    });
  });
  // Handle the "Next" button clicks
  $('.next').click(function() {
    // Get the current form block
    var currentBlock = $(this).closest('.form-block');
    
    // Check if all the required fields are filled
    var requiredFields = currentBlock.find(':input[required]');
    if (requiredFields.filter(function() { return this.value == ''; }).length == 0) {
      // Remove any existing error styles
      requiredFields.removeClass('error');
      
      // Hide the current form block and show the next one
      currentBlock.hide().next('.form-block').fadeIn();
    } else {
      // Highlight the missing required fields in red
      requiredFields.removeClass('error');
      requiredFields.filter(function() { return this.value == ''; }).addClass('error');
      
      // Scroll to the first missing required field
      $('html, body').animate({
        scrollTop: requiredFields.filter(function() { return this.value == ''; }).first().offset().top - 50
      }, 500);
      
      // Prevent the form from navigating to the next block
      return false;
    }
  });
  
  // Handle the "Prev" button clicks
  $('.prev').click(function() {
    // Hide the current form block and show the previous one
    $(this).closest('.form-block').hide().prev('.form-block').fadeIn();
  });
  
  // Handle the form submission
  $('#register-form').submit(function(event) {
    // Check if all the required fields are filled
    var requiredFields = $(this).find(':input[required]');
    if (requiredFields.filter(function() { return this.value == ''; }).length == 0) {
      // Remove any existing error styles
      requiredFields.removeClass('error');
      
      // Submit the form data using AJAX
      $.ajax({
        url: $(this).attr('action'),
        type: $(this).attr('method'),
        data: $(this).serialize(),
        success: function() {
          // Show a success message
          alert('Form submitted successfully!');
        },
        error: function() {
          // Show an error message
          alert('Error submitting form!');
        }
      });
    } else {
      // Highlight the missing required fields in red
      requiredFields.filter(function() { return this.value == ''; }).addClass('error');
      
      // Scroll to the first missing required field
      $('html, body').animate({
        scrollTop: requiredFields.filter(function() { return this.value == ''; }).first().offset().top - 50
      }, 500);
      
      // Prevent the form from submitting
      return false;
    }
  });
});


</script>

<form id="register-form">

  
  <!-- 1st form block -->
  <div class="form-block" id="block1">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required >
    <br>
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required data-name="email">
    <input type="button" id="send-otp" value="Send OTP">
    <br>
     <!-- otp block -->
      <div id="hide_otp">
        <label for="otp">OTP:</label>
        <input type="text" id="otp" name="otp" required data-name="otp">
        <br>
        <input type="button" id="verify-otp" value="Verify OTP">
      </div>  
    
    <button type="button" class="next">Next</button>
  </div>



  
  <!--2nd form block -->
  <div class="form-block" id="block2">
    <label for="age">Age:</label>
    <input type="number" id="age" name="age" required>
    <br>
    <label for="address">Address:</label>
    <input type="text" id="address" name="address" required>
    <br>
    <button type="button" class="prev">Prev</button>
    <button type="button" class="next">Next</button>
  </div>


  
  <!-- 3rd form block -->
  <div class="form-block" id="block3">
    <label for="phone">Phone:</label>
    <input type="text" id="phone" name="phone" required>
    <br>
    <label for="message">Message:</label>
    <textarea id="message" name="message" required></textarea>
    <br>
    <button type="button" class="prev">Prev</button>
    <button type="button" class="next">Next</button>
  </div>


  
  <!-- 4th form block -->
  <div class="form-block" id="block4">
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>
    <br>
    <button type="button" class="prev">Prev</button>
    <button type="submit">Submit</button>
  </div>
</form>
